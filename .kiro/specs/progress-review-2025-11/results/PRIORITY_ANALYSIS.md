# Priority Analysis: 優先順位付けマトリクス

**Analysis Date**: 2025-11-15  
**Method**: インパクト × 難易度マトリクス

---

## 優先順位マトリクス

```
        難易度
        低        中        高
    高  A1 (7)   A2 (5)   A3 (2)
イ  中  B1 (8)   B2 (9)   B3 (4)
ン  低  C1 (5)   C2 (3)   C3 (0)
パ
ク
ト

括弧内は該当機能数
```

---

## A1: 高インパクト × 低難易度（最優先）

### 1. 横書きテキスト（Phase 4候補）
- **インパクト**: 高（プロダクトビジョンの中核、情報伝達に必須）
- **難易度**: 低（DirectWrite基本API、1週間）
- **理由**: テキストなしでは実用的なアプリケーションが作れない
- **推定工数**: 2週間

### 2. 画像表示（Phase 5候補）
- **インパクト**: 高（「伺か」の立ち絵表示に必須）
- **難易度**: 低（WIC基本統合、既存APIあり）
- **理由**: キャラクター表示はプロダクトの華
- **推定工数**: 1週間

### 3. ヒットテスト（Phase 3候補）
- **インパクト**: 高（透過ウィンドウのインタラクションに必須）
- **難易度**: 低-中（WM_NCHITTEST実装）
- **理由**: 透過ウィンドウでのクリック判定が必要
- **推定工数**: 2週間

### 4. 完全な透過ウィンドウ（Phase 3候補）
- **インパクト**: 高（デスクトップマスコットに必須）
- **難易度**: 低（DirectComposition透過、既に部分実装）
- **理由**: 「伺か」らしさの実現
- **推定工数**: 1週間

### 5. ボタンウィジット
- **インパクト**: 高（基本UIコンポーネント）
- **難易度**: 低（Rectangle + クリックイベント）
- **理由**: インタラクティブUIの基礎
- **推定工数**: 1週間

### 6. ラベルウィジット
- **インパクト**: 高（テキスト表示の基本）
- **難易度**: 低（テキストレンダリング統合）
- **理由**: 横書きテキスト完了後すぐ実装可能
- **推定工数**: 3日

### 7. 画像ウィジット
- **インパクト**: 高（画像表示の基本）
- **難易度**: 低（WIC統合後すぐ実装可能）
- **理由**: 立ち絵表示に必須
- **推定工数**: 3日

---

## A2: 高インパクト × 中難易度

### 1. taffy統合（レイアウト基盤）
- **インパクト**: 高（自動レイアウトの基礎）
- **難易度**: 中（既存ライブラリ統合、3週間）
- **理由**: 手動配置からの脱却
- **推定工数**: 3週間

### 2. ウィジット自動配置
- **インパクト**: 高（レイアウトシステムの実現）
- **難易度**: 中（taffy統合後）
- **理由**: 開発効率の大幅向上
- **推定工数**: 2週間

### 3. マウスドラッグ
- **インパクト**: 高（ウィンドウ移動、D&D等）
- **難易度**: 中（マウス追跡実装）
- **理由**: インタラクションの基本
- **推定工数**: 1週間

### 4. API docコメント拡充
- **インパクト**: 高（開発体験・保守性向上）
- **難易度**: 中（全APIに対応、継続的作業）
- **理由**: プロジェクトの成熟度向上
- **推定工数**: 2週間

### 5. アーキテクチャ図作成
- **インパクト**: 高（新規参加者の理解促進）
- **難易度**: 低-中（図の作成）
- **理由**: ドキュメント改善の優先課題
- **推定工数**: 3日

---

## A3: 高インパクト × 高難易度

### 1. 縦書きテキスト（最終目標、Phase 6候補）
- **インパクト**: 高（プロダクトの最終目標）
- **難易度**: 高（DirectWrite高度な機能、4週間以上）
- **理由**: プロダクト名「Tategaki Framework」の由来
- **推定工数**: 4週間

### 2. テキストボックスウィジット
- **インパクト**: 高（入力UIの基本）
- **難易度**: 高（IME統合必要）
- **理由**: ユーザー入力の実現
- **推定工数**: 3週間

---

## B1: 中インパクト × 低難易度

### 1. マウスクリック
- **インパクト**: 中（基本イベント）
- **難易度**: 低（WM_LBUTTONDOWN）
- **理由**: ボタン等の前提
- **推定工数**: 1週間

### 2-8. その他低難易度機能（省略）
- ウィンドウ位置・サイズ動的変更
- マウスホバー
- タイマーイベント
- FPS計測
- メモリ計測
- 円・三角ウィジット
- グラデーション

---

## B2: 中インパクト × 中難易度

### 1-9. 中難易度機能（省略）
- キーボード入力
- アニメーション
- レスポンシブレイアウト
- 制約ベースレイアウト
- エフェクト
- 構造化ログ
- チュートリアル作成
- テスト拡充
- etc.

---

## 優先順位リスト（Top 10）

| 順位 | 機能 | マトリクス | インパクト | 難易度 | 推定工数 | Phase候補 |
|-----|------|-----------|-----------|--------|----------|----------|
| 1 | ヒットテスト | A1 | 高 | 低-中 | 2週間 | Phase 3 |
| 2 | 完全な透過ウィンドウ | A1 | 高 | 低 | 1週間 | Phase 3 |
| 3 | 横書きテキスト | A1 | 高 | 低 | 2週間 | Phase 4 |
| 4 | 画像表示 | A1 | 高 | 低 | 1週間 | Phase 5 |
| 5 | ラベルウィジット | A1 | 高 | 低 | 3日 | Phase 4 |
| 6 | 画像ウィジット | A1 | 高 | 低 | 3日 | Phase 5 |
| 7 | ボタンウィジット | A1 | 高 | 低 | 1週間 | Phase 4-5 |
| 8 | taffy統合 | A2 | 高 | 中 | 3週間 | Phase 6 |
| 9 | マウスドラッグ | A2 | 高 | 中 | 1週間 | Phase 3 |
| 10 | API docコメント | A2 | 高 | 中 | 2週間 | 継続的 |

---

## 推奨実装順序

### Phase 3: 透過ウィンドウとヒットテスト（2-3週間）
1. 完全な透過ウィンドウ（1週間）
2. ヒットテスト（2週間）
3. マウスドラッグ（1週間）

### Phase 4: 横書きテキスト（3週間）
1. DirectWrite統合（2週間）
2. ラベルウィジット（3日）
3. ボタンウィジット（1週間）

### Phase 5: 画像表示（2週間）
1. WIC統合（1週間）
2. 画像ウィジット（3日）
3. サンプル作成（3日）

### Phase 6: レイアウトシステム（5週間）
1. taffy統合（3週間）
2. ウィジット自動配置（2週間）

### Phase 7: 縦書きテキスト（4週間以上）
- プロダクト最終目標

---

## 決定理由の詳細

### なぜPhase 3を優先？
1. **README.mdロードマップとの整合**: Phase 3として記載されている
2. **透過ウィンドウの完成**: Phase 2で部分実装済み、完成させる意義
3. **インタラクションの基盤**: ヒットテストはすべてのイベント処理の前提
4. **比較的低難易度**: 2-3週間で完了可能

### なぜPhase 4（テキスト）を次に？
1. **実用性の向上**: テキストなしでは実用的なアプリケーションが作れない
2. **プロダクトビジョン**: 「伺か」らしさには会話（テキスト）が必須
3. **DirectWriteの活用**: 既に初期化済み、統合が容易
4. **Phase 6（縦書き）への布石**: 横書きで基盤を作り、縦書きに発展

### なぜPhase 5（画像）を次に？
1. **視覚的インパクト**: キャラクター立ち絵の表示
2. **WIC統合**: 比較的簡単（1週間）
3. **プロダクトの華**: アプリケーションが一気に魅力的に

---

## 関連ドキュメント

- [FEATURE_MATRIX.md](./FEATURE_MATRIX.md) - 未実装機能マトリクス
- [NEXT_MILESTONES.md](./NEXT_MILESTONES.md) - 次期マイルストーン提案

---

_Priority Analysis completed on 2025-11-15_
