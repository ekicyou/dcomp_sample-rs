use pasta_stdlib::*;

pub mod メイン_1 {
    use pasta_stdlib::*;
    use crate::{うにゅう, さくら};

    pub fn __start__(ctx, args) {
        let カウンタ = 10;
        ctx.actor = さくら;
        yield Actor("さくら");
        yield pasta_stdlib::word(ctx, "挨拶", []);
        ctx.actor = うにゅう;
        yield Actor("うにゅう");
        yield pasta_stdlib::word(ctx, "ローカル関数", ["はろー"]);
        for a in crate::pasta::call(ctx, "自己紹介", #{}, []) { yield a; }
        let カウンタ = 1;
        for a in crate::pasta::call(ctx, "カウント表示", #{}, [カウンタ]) { yield a; }
        for a in crate::pasta::jump(ctx, "会話分岐", #{}, []) { yield a; }
    }
    pub fn 自己紹介_1(ctx, args) {
        ctx.actor = さくら;
        yield Actor("さくら");
        yield Talk("私はさくらです。");
        ctx.actor = うにゅう;
        yield Actor("うにゅう");
        yield Talk("僕はうにゅうだよ。");
        for a in crate::pasta::call(ctx, "趣味紹介", #{}, []) { yield a; }
    }

    pub fn 趣味紹介_1(ctx, args) {
        ctx.actor = さくら;
        yield Actor("さくら");
        yield Talk("私の趣味は読書です。");
        ctx.actor = うにゅう;
        yield Actor("うにゅう");
        yield Talk("僕はゲームが好き。");
    }

    pub fn カウント表示_1(ctx, args) {
        ctx.actor = さくら;
        yield Actor("さくら");
        yield Talk("カウンターは＄値です。");
    }

    pub fn 会話分岐_1(ctx, args) {
        ctx.actor = さくら;
        yield Actor("さくら");
        yield pasta_stdlib::word(ctx, "場所の天気は", []);
        yield pasta_stdlib::word(ctx, "天気だね", []);
        yield Talk("。");
        ctx.actor = うにゅう;
        yield Actor("うにゅう");
        yield Talk("そうだね。");
        for a in crate::pasta::jump(ctx, "別の話題", #{}, []) { yield a; }
    }

    pub fn 別の話題_1(ctx, args) {
        ctx.actor = さくら;
        yield Actor("さくら");
        yield Talk("ところで、明日は何する？");
        ctx.actor = うにゅう;
        yield Actor("うにゅう");
        yield Talk("まだ決めてないなぁ。");
        pub fn ローカル関数(ctx, args) {
        let メッセージ = args[0];
        ctx.actor = super::うにゅう;
        yield #{ type: "Actor", actor: ctx.actor };
        yield #{ type: "Talk", text: `ローカル関数が呼ばれました: ${メッセージ}` };
        }
    }

}

pub mod pasta {

    pub fn jump(ctx, label, filters, args) {
        let id = pasta_stdlib::select_label_to_id(label, filters);
        match id {
            1 => { for a in crate::メイン_1::__start__(ctx, args) { yield a; } },
            2 => { for a in crate::メイン_1::自己紹介_1(ctx, args) { yield a; } },
            3 => { for a in crate::メイン_1::趣味紹介_1(ctx, args) { yield a; } },
            4 => { for a in crate::メイン_1::カウント表示_1(ctx, args) { yield a; } },
            5 => { for a in crate::メイン_1::会話分岐_1(ctx, args) { yield a; } },
            6 => { for a in crate::メイン_1::別の話題_1(ctx, args) { yield a; } },
            _ => { yield pasta_stdlib::Error(`ラベルID ${id} が見つかりませんでした。`); },
        }
    }

    pub fn call(ctx, label, filters, args) {
        let id = pasta_stdlib::select_label_to_id(label, filters);
        match id {
            1 => { for a in crate::メイン_1::__start__(ctx, args) { yield a; } },
            2 => { for a in crate::メイン_1::自己紹介_1(ctx, args) { yield a; } },
            3 => { for a in crate::メイン_1::趣味紹介_1(ctx, args) { yield a; } },
            4 => { for a in crate::メイン_1::カウント表示_1(ctx, args) { yield a; } },
            5 => { for a in crate::メイン_1::会話分岐_1(ctx, args) { yield a; } },
            6 => { for a in crate::メイン_1::別の話題_1(ctx, args) { yield a; } },
            _ => { yield pasta_stdlib::Error(`ラベルID ${id} が見つかりませんでした。`); },
        }
    }
}
